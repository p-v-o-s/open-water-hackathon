<!DOCTYPE html>
<!-- saved from url=(0055)http://bost.ocks.org/mike/cubism/intro/demo-stocks.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8">
<style>

body {
  font-family: "Helvetica Neue", Helvetica, sans-serif;
  margin: 30px auto;
  width: 1280px;
  position: relative;
}

header {
  padding: 6px 0;
}

.group {
  margin-bottom: 1em;
}

.axis {
  font: 10px sans-serif;
  position: fixed;
  pointer-events: none;
  z-index: 2;
}

.axis text {
  -webkit-transition: fill-opacity 250ms linear;
}

.axis path {
  display: none;
}

.axis line {
  stroke: #000;
  shape-rendering: crispEdges;
}

.axis.top {
  background-image: linear-gradient(top, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -o-linear-gradient(top, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -moz-linear-gradient(top, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -webkit-linear-gradient(top, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -ms-linear-gradient(top, #fff 0%, rgba(255,255,255,0) 100%);
  top: 0px;
  padding: 0 0 24px 0;
}

.axis.bottom {
  background-image: linear-gradient(bottom, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -o-linear-gradient(bottom, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -moz-linear-gradient(bottom, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -webkit-linear-gradient(bottom, #fff 0%, rgba(255,255,255,0) 100%);
  background-image: -ms-linear-gradient(bottom, #fff 0%, rgba(255,255,255,0) 100%);
  bottom: 0px;
  padding: 24px 0 0 0;
}

.horizon {
  border-bottom: solid 1px #000;
  overflow: hidden;
  position: relative;
}

.horizon {
  border-top: solid 1px #000;
  border-bottom: solid 1px #000;
}

.horizon + .horizon {
  border-top: none;
}

.horizon canvas {
  display: block;
}

.horizon .title,
.horizon .value {
  bottom: 0;
  line-height: 30px;
  margin: 0 6px;
  position: absolute;
  text-shadow: 0 1px 0 rgba(255,255,255,.5);
  white-space: nowrap;
}

.horizon .title {
  left: 0;
}

.horizon .value {
  right: 0;
}

.line {
  background: #000;
  z-index: 2;
}

</style>
<script src="./demo-stocks_files/d3.v2.js"></script>
<script src="./demo-stocks_files/cubism.v1.js"></script>
</head><body id="demo" class=" hasGoogleVoiceExt">
<script>

var context = cubism.context()
    .serverDelay(new Date(2012, 4, 2) - Date.now())
    .step(864e5)
    .size(1280)
    .stop();

d3.select("#demo").selectAll(".axis")
    .data(["top", "bottom"])
  .enter().append("div")
    .attr("class", function(d) { return d + " axis"; })
    .each(function(d) { d3.select(this).call(context.axis().ticks(12).orient(d)); });

d3.select("body").append("div")
    .attr("class", "rule")
    .call(context.rule());

d3.select("body").selectAll(".horizon")
    .data(["AAPL", "BIDU", "SINA", "GOOG", "MSFT", "YHOO", "ADBE", "REDF", "INSP", "IACI", "AVID", "CCUR", "DELL", "DGII", "HPQ", "SGI", "SMCI", "SNDK", "SYNA"].map(stock))
  .enter().insert("div", ".bottom")
    .attr("class", "horizon")
  .call(context.horizon()
    .format(d3.format("+,.2p")));

context.on("focus", function(i) {
  d3.selectAll(".value").style("right", i == null ? null : context.size() - i + "px");
});

// Replace this with context.graphite and graphite.metric!
function stock(name) {
  var format = d3.time.format("%d-%b-%y");
  return context.metric(function(start, stop, step, callback) {
    d3.csv("stocks/" + name + ".csv", function(rows) {
      rows = rows.map(function(d) { return [format.parse(d.Date), +d.Open]; }).filter(function(d) { return d[1]; }).reverse();
      var date = rows[0][0], compare = rows[400][1], value = rows[0][1], values = [value];
      rows.forEach(function(d) {
        while ((date = d3.time.day.offset(date, 1)) < d[0]) values.push(value);
        values.push(value = (d[1] - compare) / compare);
      });
      callback(null, values.slice(-context.size()));
    });
  }, name);
}

</script><div class="top axis"><svg width="1280" height="28"><g transform="translate(0,27)"><g transform="translate(81.16666666666667,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">July</text></g><g transform="translate(173.16666666666666,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><g transform="translate(265.2083333333333,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">2013</text></g><g transform="translate(355.16666666666663,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">April</text></g><g transform="translate(446.1666666666667,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">July</text></g><g transform="translate(538.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><g transform="translate(630.2083333333334,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">2014</text></g><g transform="translate(720.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">April</text></g><g transform="translate(811.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 0;">July</text></g><g transform="translate(903.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><g transform="translate(995.2083333333333,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">2015</text></g><g transform="translate(1085.1666666666667,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">April</text></g><g transform="translate(1176.1666666666665,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">July</text></g><g transform="translate(1268.1666666666665,0)" style="opacity: 1;"><line class="tick" y2="-6" x2="0"></line><text y="-9" x="0" dy="0em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><path class="domain" d="M0,-6V0H1280V-6"></path><text y="-9" x="797" dy="0em" text-anchor="middle" style="fill-opacity: 1;">June 16</text></g></svg></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">AAPL</span><span class="value" style="right: 483px;">+290%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">BIDU</span><span class="value" style="right: 483px;">+840%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">SINA</span><span class="value" style="right: 483px;">+230%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">GOOG</span><span class="value" style="right: 483px;">+120%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">MSFT</span><span class="value" style="right: 483px;">+54%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">YHOO</span><span class="value" style="right: 483px;">+82%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">ADBE</span><span class="value" style="right: 483px;">+47%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">REDF</span><span class="value" style="right: 483px;">+150%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">INSP</span><span class="value" style="right: 483px;">+20%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">IACI</span><span class="value" style="right: 483px;">+100%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">AVID</span><span class="value" style="right: 483px;">+43%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">CCUR</span><span class="value" style="right: 483px;">+67%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">DELL</span><span class="value" style="right: 483px;">+33%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">DGII</span><span class="value" style="right: 483px;">+71%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">HPQ</span><span class="value" style="right: 483px;">+36%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">SGI</span><span class="value" style="right: 483px;">+200%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">SMCI</span><span class="value" style="right: 483px;">+190%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">SNDK</span><span class="value" style="right: 483px;">+720%</span></div><div class="horizon"><canvas width="1280" height="30"></canvas><span class="title">SYNA</span><span class="value" style="right: 483px;">+26%</span></div><div class="bottom axis"><svg width="1280" height="28"><g transform="translate(0,4)"><g transform="translate(81.16666666666667,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">July</text></g><g transform="translate(173.16666666666666,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><g transform="translate(265.2083333333333,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">2013</text></g><g transform="translate(355.16666666666663,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">April</text></g><g transform="translate(446.1666666666667,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">July</text></g><g transform="translate(538.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><g transform="translate(630.2083333333334,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">2014</text></g><g transform="translate(720.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">April</text></g><g transform="translate(811.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 0;">July</text></g><g transform="translate(903.1666666666666,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><g transform="translate(995.2083333333333,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">2015</text></g><g transform="translate(1085.1666666666667,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">April</text></g><g transform="translate(1176.1666666666665,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">July</text></g><g transform="translate(1268.1666666666665,0)" style="opacity: 1;"><line class="tick" y2="6" x2="0"></line><text y="9" x="0" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">October</text></g><path class="domain" d="M0,6V0H1280V6"></path><text y="9" x="797" dy=".71em" text-anchor="middle" style="fill-opacity: 1;">June 16</text></g></svg></div><div class="rule"><div class="line" style="position: absolute; top: 0px; bottom: 0px; width: 1px; pointer-events: none; left: 797px;"></div></div>
</body></html>
